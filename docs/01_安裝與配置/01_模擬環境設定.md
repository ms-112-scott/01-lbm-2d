# 01\_模擬環境設定

本篇指南將協助您建立執行 Taichi LBM-2D 模擬所需的軟體環境。

## 1. 系統需求

- **作業系統**: Windows 10/11, Linux (Ubuntu 20.04+), macOS (10.15+)
- **Python 版本**: 3.8 ~ 3.13 (建議 3.13)
- **硬體需求**:
  - **GPU (強烈建議)**: NVIDIA GPU (支援 CUDA) 或 Apple Silicon (Metal)。
  - **CPU**: 若無 GPU，Taichi 可切換至 CPU 模式，但運算速度會顯著下降。
  - **RAM**: 建議 16GB 以上 (視網格解析度而定，2048x1024 解析度約需 2-4GB VRAM)。

## 2. 安裝步驟

### 步驟 1: 建立虛擬環境 (建議)

為了避免套件衝突，建議使用 Conda 或 venv 建立獨立環境。

```bash
# 使用 Conda
conda create -n lbm_env python=3.13
conda activate lbm_env

# 或使用 venv (Windows)
python -m venv .venv
.venv\Scripts\activate
```

### 步驟 2: 安裝相依套件

專案根目錄下附有 `requirements.txt`，包含核心庫 `taichi`, `numpy`, `opencv-python`, `h5py` 等。

```bash
pip install -r requirements.txt
```

**關鍵套件說明:**

- `taichi`: 高效能平行運算框架。
- `numpy`: 數值運算。
- `opencv-python`: 影像處理與 Mask 讀取。
- `h5py`: 處理 HDF5 格式輸出。
- `scipy`: 用於計算 SDF (Signed Distance Field)。
- `imageio-ffmpeg`: 用於輸出 MP4 影片。

### 步驟 3: 驗證安裝

請執行以下 Python 指令，確認 Taichi 能正確抓到您的 GPU：

```python
import taichi as ti
ti.init(arch=ti.gpu)
print("Taichi initialized successfully!")
```

若輸出成功且無錯誤訊息，代表環境已就緒。

---

## 3. 常見問題 (FAQ)

**Q: 出現 `Taichi Compilation Error`?**
A: 請確認您的顯示卡驅動程式已更新至最新版本。

**Q: 如何強制使用 CPU?**
A: 在程式碼或設定中將 `arch` 設為 `ti.cpu`，或設定環境變數 `TI_ARCH=cpu`。

**Q: 缺少 `ffmpeg`?**
A: `imageio-ffmpeg` 通常會自動下載執行檔。若仍有問題，請手動安裝 FFmpeg 並加入系統 PATH。
