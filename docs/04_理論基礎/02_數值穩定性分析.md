# LBM-MRT 數值穩定性分析

## 1. 關於「短時間可壓縮，長時間不可壓縮」

這句話精準描述了 LBM (以及人工壓縮性方法) 的核心運作機制。

- **LBM 本質**：弱可壓縮 (Weakly Compressible)。壓力直接由密度決定 ($P = c_s^2 ho$)。
- **短時間 (Transient)**：當流體受到擾動 (如風吹過障礙物)，LBM 會產生**聲波 (Sound Waves)**。這就是「壓縮波」，對於不可壓縮流體模擬來說，這些是高頻噪音。
- **長時間 (Steady State)**：隨著時間推移，黏滯力與鬆弛機制會耗散這些聲波。留下來的就是穩定的不可壓縮流場。

MRT 的作用就是加速這個「去噪」過程。透過將 **Ghost Mode (非物理模態)** 的鬆弛率設為穩定值 (如 1.1)，我們可以快速消除短時間的壓縮聲波。

---

## 2. 衰退 (Relaxation) 與黏度 ($
u$)

### 2.1 衰退的本質：回歸平靜

LBM 的每一個時間步都在強迫應力 (Stress) 值「往平衡態靠近」。
$$ m^* = m - s \cdot (m - m^{eq}) $$
$$ m^* = (1 - s) \cdot m + s \cdot m^{eq} $$

- **$s$ (Relaxation Rate)**: 衰退係數，範圍 $0 < s < 2$。
- **$1 - s$**: **衰退因子 (Decay Factor)**。

### 2.2 黏度與 $s$ 的反比關係

物理黏度 $
u$ 與鬆弛率 $s_{
u}$ 的關係為：
$$ 
u = c_s^2 \left( \frac{1}{s_{
u}} - 0.5 ight) \Delta t $$
$$ s_{
u} = \frac{1}{	au} = \frac{2}{6
u + 1} $$ (假設 $c_s^2 = 1/3, \Delta t=1$)

讓我們代入數值感受一下：

1.  **高黏度 (蜂蜜)**: $
u = 10.0$
    - $s_{
u} \approx 0.03$
    - 衰退因子 $1 - s \approx 0.97$
    - **物理意義**: 應力每一道手續只衰退 3%。高黏度流體有很強的「記憶性」，應力不容易消失。

2.  **低黏度 (空氣/水)**: $
u = 0.005$
    - $s_{
u} \approx 1.94$
    - 衰退因子 $1 - s \approx -0.94$
    - **物理意義**: 應力每一道手續不僅衰退了，還**反向跳動 (Over-relaxation)**。

### 2.3 空氣模擬的危險性

對於建築風場 (低黏度空氣)，我們被迫使用接近 2.0 的 $s_{
u}$。這意味著應力值會在正負之間劇烈震盪：
$$ m ightarrow -0.94 m ightarrow 0.88 m ightarrow -0.83 m \dots $$

如果 $s_{
u}$ 超過 2.0，衰退因子變成 $<-1$ (例如 -1.1)，震盪就會越來越大，導致數值爆炸 (Blow up)。

---

## 3. MRT 穩定性策略

在 BGK (SRT) 模型中，所有模態 (包含噪音) 都必須使用同一個危險的鬆弛率 $s_{
u} \approx 1.94$。一旦噪音震盪，模擬就會崩潰。

**MRT 的解決方案**:
1.  **物理項 (應力)**: 保持 $s_{
u} \approx 1.94$，允許真實的物理震盪 (湍流)。
2.  **非物理項 (鬼影)**: 設定為 $s_{ghost} \approx 1.1$。
    - 衰退因子 $1 - 1.1 = -0.1$。
    - 噪音每一道手續就縮小成原來的 10%。**噪音瞬間被殺死了**。

**結論**: MRT 允許我們保留「物理上的劇烈反應」，同時「按住」數值噪音不讓它失控。

---

## 4. 穩定性報告與除錯紀錄

在專案開發初期，我們遇到了在目標雷諾數下模擬發散的問題。經過分析：

1.  **參數調整無效**: 單純增加 $
u$ 或降低速度雖然能穩定，但犧牲了物理真實性 (雷諾數過低)。
2.  **幾何無關**: 圓形或矩形障礙物皆會發散。
3.  **根本原因**: 確認為 MRT 碰撞矩陣 $\mathbf{M}$ 與平衡態 $m^{eq}$ 計算不匹配。
    - **修正**: 採用標準 Lallemand & Luo (2000) 的 D2Q9 MRT 定義，並重新校對了程式碼中的矩陣係數。
    - **驗證**: 修正後，模擬器成功在 $Re=5000+$ 的高雷諾數下穩定運行。
